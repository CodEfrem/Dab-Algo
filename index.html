<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>DAB</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
</head>

<body>
    <header class="container">
        <h1 align="center">Retrait DAB</h1>
        <p align="center">
            Veuillez cliquer sur le bouton ci-dessous pour retirer de l'argent
        </p>
        <button onclick="cardChecker()">Commencer</button>
    </header>
    <main class="container">
        <h1 class="app"></h1>
    </main>

    <script>
        // variables
        const clientBalance = 1200
        const atmBalance = 1200
        const passCard = 9513
 
        const app = document.querySelector(".app")

        
        // Functions
        /*
        Type de cartes de l'app :
        1 : CB Valide
        2 : CB non valide
        3 : CB Bloquée
        */ 

        function cardChecker (){
            let card = parseInt(prompt('Choisissez une carte : 1, 2 ou 3'))
            
                if (card===2 || card != 1) {
                    if (card === 2) {
                    app.innerText = 'CB Bloquée'

                } else {
                    app.innerText =  'CB Non valide'
                
                }
            }
            else {
                passChecker()
                
            }
        }
        /*
        * Cette fonction permet de vérifier le code de la carte :
        * à l'aide d'une boucle nous allons permettre 3 essais
        * Si un des 3 essais est valide, on met le compte de la boucle
        * au maximum afin de l'arreter et on lance la fonction pour
        * choisir le montant à retirer.
        */
        function passChecker (){
            
            app.innerText = 'CB valide'
            for (let index = 0; index < 3; index++) {
                    let passPrompt = parseInt(prompt('Saissisez votre code'))
                    if(passPrompt === passCard){
                        index = 3 
                        amountChoise()
                        
        } 
    }
}
        function amountChoise(){
            app.innerText = 'Combien voulez-vous retirer ?'
            let amount = parseInt(prompt('Choisissez un montant : 20, 50, 100, 200, 500, 1000'))
            if (amount > clientBalance) {
                app.innerText = 'Solde insuffisant'
            } else {
                if (amount > atmBalance) {
                    app.innerText = 'Solde du DAB insuffisant'
                } else {
                    app.innerText = 'Retrait de ' + amount + '€'
                }
            }
        }







    </script>
</body>
</html>